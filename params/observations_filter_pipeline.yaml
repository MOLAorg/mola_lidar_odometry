# Filters:
#
# One filter object will be created for each entry, instancing the given class,
# and with the given parameters. Filters are run in definition order on the
# input metric_map_t object.
#
- class_name: mp2p_icp_filters::FilterBoundingBox
  params:
    input_pointcloud_layer: 'raw'
    output_pointcloud_layer: 'filtered'
    keep_bbox_contents: false  # Remove points in this bbox:
    bounding_box_min: [-4, -4, -4]
    bounding_box_max: [+4, +4, +4]

- class_name: mp2p_icp_filters::FilterDecimateVoxelsQuadratic
  params:
    input_pointcloud_layer: 'filtered'
    output_pointcloud_layer: 'decimated_for_icp'
    voxel_filter_resolution: 1.5  # [m]
    quadratic_reference_radius: 40.0
    use_voxel_average: false
    use_closest_to_voxel_average: true
    use_random_point_within_voxel: true

- class_name: mp2p_icp_filters::FilterDecimateVoxels
  params:
    input_pointcloud_layer: 'filtered'
    output_pointcloud_layer: 'decimated_for_map_insert'
    voxel_filter_resolution: 0.75  # [m]
    use_voxel_average: false
    use_closest_to_voxel_average: false
    use_random_point_within_voxel: true

# Remove layers to save memory and log file storage
- class_name: mp2p_icp_filters::FilterDeleteLayer
  params:
    pointcloud_layer_to_remove: 'filtered'

- class_name: mp2p_icp_filters::FilterDeleteLayer
  params:
    pointcloud_layer_to_remove: 'raw'
